
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>

<title>Date Range Check in SQL Server | thecave</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="robots" content="index, follow" />

<link rel="stylesheet" type="text/css" href="/styles/typebased/style.css" />
<link rel="alternate" type="application/atom+xml" title="Atom 0.3" href="/atom.xml" />

<!--[if IE 6]>
<script type="text/javascript" src="/styles/typebased/includes/js/menu.js"></script>
<![endif]-->	

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js" type="text/javascript"></script>
<script type='text/javascript' src='/styles/typebased/includes/js/superfish.js?ver=3.3.2'></script>
<script type="text/javascript" src="/js/lastfm.js"></script>

<!-- Alt Stylesheet -->
<link href="/styles/typebased/styles/grey.css" rel="stylesheet" type="text/css" />

<!-- Woo Shortcodes CSS -->
<link href="/styles/typebased/functions/css/shortcodes.css" rel="stylesheet" type="text/css" />

<!-- Custom Stylesheet -->
<link href="/styles/typebased/custom.css" rel="stylesheet" type="text/css" />
<meta id="syntaxhighlighteranchor" name="syntaxhighlighter-version" content="3.1.3" />
</head>

<body class="home blog unknown">

<div id="container">

	<div id="header">
		<h1>
			<a href="/" title="Ramblings from a crotchety old man.">
			<img src="/images/thecave-logo-2.png" style="margin-top:0px;" alt="thecave" /></a></h1>
	</div>
	
	<div id="menu">
				<ul id="navigation" class="nav wrap">
										<li class="page_item current_page_item first"><a href="/"><span>Home</span></a></li>
										</ul>
			</div>
	<div class="wrap background">
		
		<div id="content" class="left-col wrap">
            <!--- Post Starts -->
<div class="post wrap page">

    <div class="post-meta left-col">
    <h3 class="wrap"><span class="month">Aug<span class="year">2005</span></span><span class="day">30</span></h3>
    <h4 class="author">kirbyt</h4>
    </div>

    <div class="post-content right-col">
    <h2><a href="/2005/08/30/date-range-check-in-sql-server/" rel="bookmark" title="Date Range Check in SQL Server">Date Range Check in SQL Server</a></h2>

    <p>I have been writing a number of stored procedures that return report data for a client. Each of these reports can be filtered by a date range, so I needed a simple way to check that a date was within a user defined date range. <br /><br />As an additional requirement, if the user does not specify a begin date or end date as part of the date range then the earliest or latest supported date respectively should be used. In other words, if the user does not specify a begin date then the earliest date supported by SQL Server should be used as the begin date, and if the user does not specify the end date then the latest date supported is used for the end date.<br /><br />My original approach was to use a BETWEEN clause in the SELECT statements. However, this made the code messy especially with the ISNULL call used to set the begin end dates when NULL. So I swapped out the code with a user-defined function.<br /><br />The user-defined function <b>fnIsInDateRange</b> takes 3 parameters:<ul><li>Date to check</li><li>Beginning date of the date range</li><li>Ending date of the date range</li></ul><br />The function returns one of the following:<ul><li><b>-1</b> if the date is before the range</li><li><b>0</b> if the date is within the range</li><li><b>1</b> if the date is beyond the range</li></ul><br />Here&#8217;s the code for those who want it.<pre><br />CREATE FUNCTION dbo.fnIsInDateRange<br />/* <br />  Determines if the date time value is within the date time range.<br /> <br />  Returns:<br />  -1 if the date is before the date range.<br />   0 if the date is within the date range.<br />   1 if the date is after the date range.<br /> <br />  Usage:<br />   SELECT dbo.fnIsInDateRange('2005-08-16','2005-08-01','2005-08-15')<br />   SELECT * FROM exams WHERE dbo.fnIsInDateRange(dtmExamDate,'2005-08-01','2005-08-15')=0<br />*/  <br />  (<br />    @value      DATETIME,<br />    @rangeFrom  DATETIME,<br />    @rangeTo    DATETIME<br />  )<br />RETURNS SMALLINT<br />AS<br />BEGIN<br />   DECLARE @result SMALLINT<br />   IF @value &lt; ISNULL(@rangeFrom,&#039;1753-01-01 00:00:00.000&#039;) <br />   BEGIN<br />      SET @result = -1<br />   END<br />   ELSE IF @value &gt; ISNULL( @rangeTo, '9999-12-31 11:59:59.997' )<br />   BEGIN<br />      SET @result = 1<br />   END<br />   ELSE<br />   BEGIN<br />      SET @result = 0<br />   END<br />   RETURN @result<br />END<br /></pre></p>


    <div>Posted in <a class='category' href='/category/blogger/'>blogger</a>.</div>
    </div>
</div>
<!--- Post Ends -->


		</div>
		
				<!--- Sidebar Starts -->
		
		<div id="sidebar" class="right-col">
		
			<div id="search">
                <form action="http://google.com/search" method="get">
                    <div>
                    <input type="hidden" name="q" value="site:thecave.com" />
					<input type="text" class="search_box" name="q" id="q" results="0" />
					<input type="image" src="/styles/typebased/images/search.gif" class="submit" name="submit" />
                    </div>
                </form>
			</div>
						
			<div id="sidebar_in">
			
			<div id="lastfm-1" class="block widget widget_lastfm">
    <h2><a href="http://last.fm/user/kirbyt" class="lastfm_title_link">Listening To</a></h2>
    <div class="lastfm">
    </div>
</div>


			
        <div id="linkcat-2" class="block widget widget_links"><h2>Blogroll</h2>
            <ul class='xoxo blogroll'>
            <li><a href="http://www.rowanturner.net/">Rowan T</a></li>
            <li><a href="http://photos.thecave.com/">Photos</a></li>
            <li><a href="http://www.learnipadprogramming.com/">Learning iPad Programming</a></li>
            <li><a href="http://blog.whitepeaksoftware.com/">White Peak Software</a></li>
            </ul>
        </div>

		<div id="linkcat-3" class="block widget widget_links"><h2>Categories</h2>
    <ul>
        <li class='category'><a href='/category/backpack/'>backpack (1)</a></li>
<li class='category'><a href='/category/backpacking/'>backpacking (8)</a></li>
<li class='category'><a href='/category/blogger/'>blogger (785)</a></li>
<li class='category'><a href='/category/camping/'>camping (11)</a></li>
<li class='category'><a href='/category/family/'>family (2)</a></li>
<li class='category'><a href='/category/fitness/'>fitness (2)</a></li>
<li class='category'><a href='/category/general/'>general (5)</a></li>
<li class='category'><a href='/category/hiking/'>hiking (6)</a></li>
<li class='category'><a href='/category/kayaking/'>kayaking (1)</a></li>
<li class='category'><a href='/category/long-trail/'>long-trail (2)</a></li>
<li class='category'><a href='/category/opinion/'>opinion (1)</a></li>
<li class='category'><a href='/category/pictures/'>pictures (2)</a></li>
<li class='category'><a href='/category/random/'>random (2)</a></li>
<li class='category'><a href='/category/rowan/'>rowan (2)</a></li>
<li class='category'><a href='/category/salem/'>salem (1)</a></li>
<li class='category'><a href='/category/skiing/'>skiing (1)</a></li>
<li class='category'><a href='/category/snowboarding/'>snowboarding (1)</a></li>
<li class='category'><a href='/category/travel/'>travel (3)</a></li>
<li class='category'><a href='/category/trip/'>trip (4)</a></li>
<li class='category'><a href='/category/trips/'>trips (1)</a></li>
<li class='category'><a href='/category/videos/'>videos (1)</a></li>

    </ul>
</div>
    
        <div id="archives-3" class="block widget widget_archive"><h2>Archives</h2>		
        <ul>
        <li><a href="/blog/archives">The Complete Blog Archives</a></li>
        </ul>
        </div>			
			
						
			</div>
				
		</div>
		
		<!--- Sidebar Ends -->		
	</div>
	
</div>
	
<div id="footer" class="wrap">

	<div class="left-col">
		<div class="popular wrap">
			<h2>Recent Articles</h2>
			<ul>
                
                  <li><a href="/2013/06/02/kayaking-the-ipswitch-river/" title="Kayaking the Ipswich River">Kayaking the Ipswich River</a></li>
                
                  <li><a href="/2013/05/24/our-visit-to-the-eiffel-tower/" title="Our Visit to the Eiffel Tower">Our Visit to the Eiffel Tower</a></li>
                
                  <li><a href="/2013/05/12/simple-banking-my-kind-of-banking/" title="Simple Bank, My Kind of Banking">Simple Bank, My Kind of Banking</a></li>
                
                  <li><a href="/2013/04/27/what-the-hell/" title="What the Hell">What the Hell</a></li>
                
                  <li><a href="/2013/02/12/nssnow-2013/" title="NSSnow 2013">NSSnow 2013</a></li>
                
            </ul>
		</div>
	</div>
	
	<div id="subscribe" class="right-col">
		<h2>Subscribe to RSS</h2>
		<p class="rss">If you enjoyed the post, make sure you subscribe to the RSS feed.</p>
		<p>
		<a href="/atom.xml">Articles</a><br />
		</p>
	</div>
	
<div id="copyright" class="wrap">

	<div class="left-col">
		<p>&copy; 2013</p>
	</div>
	
	<div class="right-col">
		<p>Design by <a href="http://woothemes.com"><img src="/styles/typebased/styles/grey/logo-footer.jpg" width="87" height="21" alt="woo themes" /></a></p>
	</div>

</div>

</div>
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-167605-3']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

</body>
</html>
<!-- Localized -->